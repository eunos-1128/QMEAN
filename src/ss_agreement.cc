// QMEAN:
// ----------
// 
// Copyright (C) 2018 University of Basel and the Authors.
// Authors: Gabriel Studer, Pascal Benkert, Marco Biasini
// 
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
// 
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
// 
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
// THE SOFTWARE.

#include "ss_agreement.hh"
#include <stdexcept>
#include <string.h>

namespace qmean{

int PsiPredToIndex(char pp)
{
  if(pp == 'H') return 0;
  if(pp == 'E') return 1;
  if(pp == 'C') return 2;
  throw std::invalid_argument("Invalid PsiPred character!");
}
int DSSPToIndex(char dssp)
{
	// psi helix ('I') is handled as helix
	// since it occurs rarely

  if(dssp == 'H') return 0;
  if(dssp == 'E') return 1;
  if(dssp == 'C') return 2;
  if(dssp == 'G') return 3;
  if(dssp == 'B') return 4;
  if(dssp == 'S') return 5;
  if(dssp == 'T') return 6;
  if(dssp == 'I') return 0;
  throw std::invalid_argument("Invalid dssp character");
}

SSAgreement::SSAgreement()
{

  Real dp[] = {0.320377378907,0.229595524812,0.198333246117,0.0412519812215,0.0119551807114,0.0832161822005,0.115270506031};

  Real pp[] = {0.00678249624599, 0.0108739903198,  0.0168759717631,
               0.00821669219601, 0.00760558458341, 0.0214136010026,
               0.00853688065485, 0.00825394403886, 0.0253445573727,
               0.00972273098582, 0.00889786875111, 0.0282005319918,
               0.0109236594437,  0.0102965867556,  0.0342238002024,
               0.0137601211927,  0.0125520971457,  0.0423526844831,
               0.0177460683784,  0.0159154063866,  0.05186609559,
               0.025107742086,   0.0215732517577,  0.0631844471782,
               0.0406444214035,  0.0322450177878,  0.0774669811195,
               0.209755370696,   0.0880633565152,  0.0715980419722};

  Real overallp[] = {0.00241870893982,  0.00301651232282,  0.00342184785106,  0.0042138929861,   0.00528798778849,  0.00757720222695,  0.0110700059692,   0.0178622586502,   0.0327771869714,   0.201080126053,
                     0.000749471600348, 0.000465648035719, 0.000450569908848, 0.000377840120412, 0.000353005558507, 0.000379614017691, 0.00029801474286,  0.000304223383337, 0.000230606646261, 0.000161424652383,
                     0.00322228440718,  0.00313270259459,  0.00379880102283,  0.00355045540378,  0.0034768386667,   0.00333847467895,  0.00305731196024,  0.00235041389458,  0.00148386507383,  0.000470082778917,

                     0.000529508337761, 0.000681176555109, 0.000671420120075, 0.000635942174497, 0.000625298790823, 0.000562325437421, 0.000545473413271, 0.000473630573474, 0.000423074501025, 0.000294466948302,
                     0.00510350247148,  0.00397264295616,  0.00459173310651,  0.00514607600618,  0.00654302011333,  0.00850228965791,  0.0116678093522,   0.0173114635451,   0.0283867912061,   0.0855249095091,
                     0.00368083685378,  0.00524364035652,  0.00520993630822,  0.00523122307557,  0.00531725709359,  0.00586450440414,  0.00580862663986,  0.00539264772795,  0.00416244996501,  0.00149184761158,

                     0.00122664996838,  0.00132953601056,  0.0012204413279,   0.00131534483233,  0.00130381450001,  0.00135348362382,  0.00133130990784,  0.0012922841677,   0.00129937975682,  0.00138275292893,
                     0.00297216489085,  0.00187855721839,  0.00189895703709,  0.00206215558676,  0.00211892029968,  0.00236726591873,  0.00258989002724,  0.00265552422656,  0.00253667310887,  0.0017552713575,
                     0.00394692144562,  0.0055310117157,   0.00715856246912,  0.00855639352492,  0.0114017247603,   0.0148519549678,   0.0198401541162,   0.0259902559822,   0.0336916310187,   0.0314742594201,

                     0.000757454138103, 0.00100668670579,  0.00105724277824,  0.00121334573879,  0.00133840549695,  0.0016000553456,   0.00187146162927,  0.00237436150785,  0.00289854815377,  0.00355045540378,
                     0.000325510150684, 0.000191580906124, 0.000222624108506, 0.000200450392519, 0.000188920060206, 0.000190693957485, 0.000172068036056, 0.000153442114627, 0.000117077220409, 5.94255588442e-05,
                     0.00154062978675,  0.00163553329117,  0.00188742670478,  0.00214198096431,  0.00253135141703,  0.00282936615989,  0.00290830458881,  0.00286927884867,  0.00227945800343,  0.00113884205307,

                     9.49035044228e-05, 0.000122398912246, 9.57904530622e-05, 9.22426585044e-05, 8.86948639465e-05, 0.000101999093538, 0.000103772990817, 7.71645316335e-05, 8.24862234703e-05, 4.34604833338e-05,
                     0.000200450392519, 0.000139250936396, 0.000164085498301, 0.000214641570751, 0.000223511057145, 0.000243910875853, 0.000302449486058, 0.000332605739799, 0.000323736253405, 0.000227945800343,
                     0.000435491781977, 0.0005303952864,   0.000632394379939, 0.000709558911572, 0.000906461509533, 0.00107586869967,  0.0012000415092,   0.0013011536541,   0.00127188434899,  0.000616429304428,

                     0.000564986283339, 0.00063062048266,  0.000591594742523, 0.000615542355789, 0.000575629667013, 0.000551682053747, 0.000591594742523, 0.000584499153408, 0.000466534984359, 0.00046476108708,
                     0.000843488156131, 0.000554342899666, 0.000543699515992, 0.000544586464632, 0.000555229848305, 0.000571194923816, 0.000602238126197, 0.000578290512931, 0.00048161311123,  0.000258989002724,
                     0.00149983014934,  0.00208876404594,  0.00259077697588,  0.00333581383303,  0.00448884706433,  0.00640110833102,  0.00875329612288,  0.0119897717083,   0.0166462520655,   0.0142506037903,

                     0.00119028507416,  0.00142976120682,  0.00147854338199,  0.00163642023981,  0.00170382833641,  0.00201337341159,  0.00223244972553,  0.00244354350173,  0.00269721081261,  0.00293934779119,
                     0.00067940265783,  0.000403561630957, 0.000382274863609, 0.000352118609868, 0.000313979818371, 0.000297127794221, 0.000282936615989, 0.000237702235377, 0.000168520241498, 7.53906343545e-05,
                     0.00254997733846,  0.00325155371228,  0.00406665951195,  0.00467510627862,  0.00610131969088,  0.00799140724158,  0.0102983606528,   0.0132909253624,   0.0179314406441,   0.0221559770138};

  memcpy(psipredP_, pp, sizeof(pp));
  memcpy(dsspP_, dp, sizeof(dp));
  memcpy(overallP_, overallp, sizeof(overallp));
}

}//namespace

